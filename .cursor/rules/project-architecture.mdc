---
alwaysApply: true
---

# LMS Project Architecture Guide

## Monorepo Structure
This is a Turborepo monorepo with the following key structure:

### Apps
- `apps/nextjs/` - Main Next.js web application
- `apps/expo/` - React Native mobile application

### Packages
- `packages/db/` - Database schema and client (Drizzle ORM + PostgreSQL)
- `packages/api/` - tRPC API routes and procedures
- `packages/ui/` - Shared UI components (shadcn/ui)
- `packages/auth/` - Authentication logic
- `packages/validators/` - Zod validation schemas
- `packages/email/` - Email templates and logic
- `packages/cache/` - Caching utilities
- `packages/upload/` - File upload utilities
- `packages/i18n/` - i18n support

### Database Schema
Core entities are defined in [packages/db/src/schema/](mdc:packages/db/src/schema/):
- `user.ts` - User accounts and profiles
- `course.ts` - Courses, modules, lessons, resources, reviews, enrollments
- `role.ts` - User roles and permissions

### API Layer
tRPC routers are in [packages/api/src/router/](mdc:packages/api/src/router/):
- Uses database schemas for input validation
- Implements CRUD operations for all entities
- Follows protected/public procedure patterns

### Frontend Structure
Next.js app uses App Router with route groups:
- `(auth)/` - Authentication pages (sign-in, sign-up, reset-password)
- `(protected)/` - Authenticated user areas (dashboard)
- `(public)/` - Public pages (course catalog, search)

## Import Patterns
Always use workspace aliases:
- `@lms/db` for database operations
- `@lms/api` for tRPC client
- `@lms/ui` for components
- `@lms/validators` for schemas
- `@lms/auth` for authentication